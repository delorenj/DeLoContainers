# Basic squid config with access control
http_port 3128

# Authentication
auth_param basic program /usr/lib/squid/basic_ncsa_auth /etc/squid/passwords
auth_param basic children 5
auth_param basic realm DeLoNET Proxy
auth_param basic credentialsttl 2 hours

# Access Control Lists
acl kids src "/etc/squid/kids_devices.txt"
acl SSL_ports port 443
acl Safe_ports port 80          # http
acl Safe_ports port 443         # https
acl CONNECT method CONNECT

# Block unsafe ports and methods
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports

# Time restrictions
acl sleep_hours time MTWHFSU 23:00-07:00
http_access deny kids sleep_hours

# Block Lists
acl adult_sites dstdom_regex "/etc/squid/adult_sites.txt"
acl violence_sites dstdom_regex "/etc/squid/violence_sites.txt"
acl gambling_sites dstdom_regex "/etc/squid/gambling_sites.txt"
acl malware dstdom_regex "/etc/squid/malware_domains.txt"
acl proxy_vpn dstdom_regex "/etc/squid/proxy_vpn.txt"

http_access deny kids adult_sites
http_access deny kids violence_sites
http_access deny kids gambling_sites
http_access deny kids proxy_vpn
http_access deny malware

# Default rules
http_access allow localhost
http_access allow kids
http_access deny all

# Optimization
cache_mem 256 MB
maximum_object_size 100 MB
cache_dir ufs /var/spool/squid 1000 16 256